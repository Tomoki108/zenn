---
title: "æ··æ²Œã¨ã—ãŸGoã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’æ”¹å–„ã™ã‚‹"
emoji: "ğŸ·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Go"]
publication_name: "castingone_dev"
published: true
---

ã“ã‚“ã«ã¡ã¯ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®æ°¸ç”°ã§ã™ã€‚

ä»Šå›ã¯ CastingONE ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ãŠã‘ã‚‹ Go ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„ã«å–ã‚Šçµ„ã‚“ã ã“ã¨ã«ã¤ã„ã¦ãŠè©±ã—ã—ã¾ã™ã€‚

å…ƒã€…ã€éæ¨å¥¨ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ã„ãŸã‚Šã€ã‚¨ãƒ©ãƒ¼ã«å¿…ãšã—ã‚‚ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãŒã¤ã„ã¦ãŠã‚‰ãšãƒ‡ãƒã‚°ã«è‹¦åŠ´ã™ã‚‹ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã€æ··æ²Œã¨ã—ãŸçŠ¶æ³ã§ã—ãŸã€‚

åŒã˜ã‚ˆã†ãªçŠ¶æ³ã‚’æŠ±ãˆã¦ã„ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚‚ã‚ã‚‹ã‹ã¨æ€ã†ã®ã§ã€è‡ªåˆ†ã®ã—ãŸå–ã‚Šçµ„ã¿ãŒä½•ã‚‰ã‹å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

## ç¾åœ¨ã®çŠ¶æ³ã®æ•´ç†

- ã‚¨ãƒ©ãƒ¼ã«ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ã¤ã‘ã‚‹ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ [github.com/pkg/errors](https://github.com/pkg/errors) ã¨ [golang.org/x/xerrors](https://pkg.go.dev/golang.org/x/xerrors) ã®äºŒã¤ãŒå°å…¥ã•ã‚Œã¦ãŠã‚Šã€æ··åœ¨ã—ã¦ã„ã‚‹ã€‚ã—ã‹ã‚‚ä¸¡æ–¹ç¾åœ¨ã¯éæ¨å¥¨ã€‚

- æ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã® `errors.New()` ã¨ `fmt.Errorf()` é–¢æ•°ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ç®‡æ‰€ãŒã‚ã‚Šã€ãã‚Œã‚‰ã‚’èµ·ç‚¹ã¨ã™ã‚‹ã‚¨ãƒ©ãƒ¼ã«ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãŒã¤ã„ã¦ã„ãªã„ã“ã¨ãŒã‚ã‚‹ã€‚

â€» github.com/pkg/errors ã‚„ golang.org/x/xerrors ãŒèª•ç”Ÿã—ãŸèƒŒæ™¯ã‚„ãªãœç¾åœ¨ã¯éæ¨å¥¨ãªã®ã‹ç­‰ã€…ã«ã¤ã„ã¦ã¯ã”æ‰¿çŸ¥ã®ã¨ãŠã‚Šè¤‡é›‘ãªèƒŒæ™¯ã‚„æ­´å²ãŒã‚ã‚‹ã‚ã‘ã§ã™ãŒã€ã“ã“ã§ã¯è§¦ã‚Œã¾ã›ã‚“ã€‚

## æ”¹å–„ã®æ‰‹é †

1. golang.org/x/xerrors ã®åˆ©ç”¨ç®‡æ‰€ã‚’ `errors.New()` ã¨ `fmt.Errorf()` é–¢æ•°ã«ç½®æ›ã—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¾å­˜é–¢ä¿‚ã‹ã‚‰ golang.org/x/xerrors ã‚’å‰Šé™¤ã™ã‚‹ã€‚

2. github.com/pkg/errors ã®ãƒ©ãƒƒãƒ‘ãƒ¼ã‚’å®Ÿè£…ã™ã‚‹ã€‚

3. AST ã‚’ç”¨ã„ã¦ github.com/pkg/errors ã®åˆ©ç”¨ç®‡æ‰€åŠã³ `errors.New()` ã¨ `fmt.Errorf()` é–¢æ•°ã‚’ãƒ©ãƒƒãƒ‘ãƒ¼ã®é–¢æ•°ã«ç½®ãæ›ãˆã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè£…ã—ã€å®Ÿè¡Œã™ã‚‹ã€‚

4. github.com/pkg/errors ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆåŠã³ `errors.New()` ã¨ `fmt.Errorf()`é–¢æ•°ã®åˆ©ç”¨ã«è­¦å‘Šã‚’å‡ºã™ãŸã‚ã® github actions ã‚’å®Ÿè£…ã—ã€é‹ç”¨ã™ã‚‹ã€‚

å‰è¿°ã®æ—¢å­˜ã®å•é¡Œã«å¯¾ã—ã¦ã€ä¸Šè¨˜ã®æ‰‹é †ã‚’è¸ã‚€ã“ã¨ã§æ”¹å–„ã‚’å›³ã‚Šã¾ã—ãŸã€‚çµæœã€ä»¥ä¸‹ã®åŠ¹æœãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚

- golang.org/x/xerrors ã¨ github.com/pkg/errors ãŒæ··åœ¨ã—ã¦ã„ã¦ã€ã—ã‹ã‚‚ã©ã¡ã‚‰ã‚‚éæ¨å¥¨ã§ã‚ã‚Šãƒ¢ãƒ¤ãƒ¢ãƒ¤ã™ã‚‹ã¨ã„ã†å•é¡ŒãŒè§£æ±ºã™ã‚‹ã€‚

- ä»Šå¾Œã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã«ã¤ã„ã¦ã€ä¹—ã‚Šæ›ãˆãŸã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã£ãŸã‚Šæ¨™æº–ã‚¨ãƒ©ãƒ¼ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æ‹¡å¼µãŒèµ·ããŸã¨ãã«ã€ãƒ©ãƒƒãƒ‘ãƒ¼ã ã‘ä¿®æ­£ã™ã‚Œã°æ¸ˆã‚€ã‚ˆã†ã«ãªã‚‹ã€‚

æ”¹å–„ã®æ‰‹é †ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã«ãã‚Œãã‚Œè£œè¶³ã—ã¦ã„ãã¾ã™ã€‚

### 1. golang.org/x/xerrors ã®é™¤å»

xerrors ã¯ README ã«ã‚‚ã‚ã‚‹ã‚ˆã†ã«ã€ãã‚Œä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‹ã‚‰ Go 1.13 ä»¥é™ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¨ãƒ©ãƒ¼ã®ä»•æ§˜å¤‰æ›´ã«å¯¾ã™ã‚‹æ©‹æ¸¡ã—çš„ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã™ã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã•ã‚‰ã«é€²ã‚“ã ç¾åœ¨ã«ãŠã„ã¦ã‚‚ä½¿ã£ã¦ã„ã‚‹ã®ã¯ãŠã‹ã—ã„ã®ã§ã€é™¤å»ã—ã¾ã™ã€‚

åˆ©ç”¨ç®‡æ‰€ã‚’æ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã® `errors.New()` ã¨ `fmt.Errorf()`ã€€ã«ç½®æ›ã™ã‚‹ã“ã¨ã§ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãŒã¤ã‹ãªããªã£ã¦ã—ã¾ã„ã¾ã™ãŒã€å¾Œã®æ‰‹é †ã‚’è¡Œãˆã°å†åº¦ã¤ãã®ã§æ°—ã«ã—ãªãã¦å¤§ä¸ˆå¤«ã§ã™ã€‚

### 2. github.com/pkg/errors ã®ãƒ©ãƒƒãƒ‘ãƒ¼ã®å®Ÿè£…

:::details code

```go
package error

// New returns an error with the supplied message.
// New also records the stack trace at the point it was called.
func New(msg string) error {
    return pkgerrors.New(msg)
}

// Errorf formats according to a format specifier and returns the string
// as a value that satisfies error.
// Errorf also records the stack trace at the point it was called.
func Errorf(format string, args ...interface{}) error {
    // pkgerrors.Errorf()ã¯%wã«å¯¾å¿œã—ã¦ã„ãªã„ãŸã‚ã€ç›´æ¥wrapã›ãšä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦ã‚ã‚‹ã€‚
    err := fmt.Errorf(format, args...)
    return pkgerrors.WithStack(err)
}

// WithStack annotates err with a stack trace at the point WithStack was called.
// If err is nil, WithStack returns nil.
func WithStack(err error) error {
    return pkgerrors.WithStack(err)
}

// Wrap returns an error annotating err with a stack trace
// at the point Wrap is called, and the supplied message.
// If err is nil, Wrap returns nil.
func Wrap(err error, message string) error {
    return pkgerrors.Wrap(err, message)
}

// Wrapf returns an error annotating err with a stack trace
// at the point Wrapf is called, and the format specifier.
// If err is nil, Wrapf returns nil.
func Wrapf(err error, format string, args ...interface{}) error {
    return pkgerrors.Wrapf(err, format, args...)
}

// WithMessage annotates err with a new message.
// If err is nil, WithMessage returns nil.
func WithMessage(err error, message string) error {
    return pkgerrors.WithMessage(err, message)
}

// WithMessagef annotates err with the format specifier.
// If err is nil, WithMessagef returns nil.
func WithMessagef(err error, format string, args ...interface{}) error {
    return pkgerrors.WithMessagef(err, message)
}
```

:::
